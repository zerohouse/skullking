<div ng-class="{myturn:(game.me.turn && game.phase==='submit') || game.phase==='prediction'}"
     class="layout-column flex wrap">
    <phase game="game"></phase>
    <prediction class="flex layout-row layout-align-center-center" game="game"
                ng-if="game.phase==='prediction'"></prediction>
    <div class="ready flex layout-row layout-align-center-center" ng-if="!game.onGame" style="overflow-y:auto">
        <div>
            <h5>{{game.name}}</h5>
            <div>게임 준비중</div>
            <div>총 {{game.maxRounds}}라운드</div>
            <div>최대 인원: {{game.maxSize}}명</div>
            <div>턴 제한시간: {{game.submitLimitTime/1000||0}}초</div>
            <div>예측 제한 시간: {{game.predictLimitTime/1000||0}}초</div>
            <div>
                <span><b>해적왕:</b> {{game.cardOptions.king}}장,</span>
                <span><b>해적:</b> {{game.cardOptions.pirate}}장,</span>
                <span><b>해적/도망:</b> {{game.cardOptions.pirateOR}}장,</span>
                <span><b>여해적:</b> {{game.cardOptions.girl}}장,</span>
                <span><b>숫자:</b> 1~{{game.cardOptions.numbers}},</span>
                <span><b>도망:</b> {{game.cardOptions.white}}장</span>
            </div>
            <div class="btn btn-primary" style="margin-top:40px;" ng-if="game.me.maker" ng-click="startGame()">게임 시작
            </div>
        </div>
    </div>
    <div ng-if="game.phase==='submit'" class="layout-column flex">
        <div class="card-block flex field layout-column layout-align-center-center" ng-drop
             ng-drop-success="submit($data)">
            <prime-color color="game.rounds.last().steps.last().prime"></prime-color>

            <div>
                <submit-card player="player" game="game"
                             ng-repeat="player in game.players | orderBy:'turnIndex'"
                             card="player.submitCard"></submit-card>
            </div>
        </div>
    </div>
    <div class="card-block hand" ng-if="game.onGame">
        <card ng-drag ng-class="{submitable:game.me.turn && card.submitable && game.phase==='submit'}"
              ng-style="getPosition($index, game.me.cards.length)" ng-drag-data="card"
              ng-repeat="card in game.me.cards track by $index"
              card="card"></card>
    </div>
    <div class="toggles layout-row">
        <span ng-if="remain>0 && game.onGame" ng-class="{red:(game.duration - remain) / 1000 < 5}" class="time">{{(game.duration - remain) >0?(game.duration - remain) / 1000:0 | number : 1}}/{{game.duration / 1000| number : 0}}</span>
        <span class="flex"></span>
        <toggle icon="{{newChat ? 'fa-commenting-o':'fa-comment-o'}}" toggle="chatShow"></toggle>
        <toggle icon="fa-user" toggle="userShow"></toggle>
        <toggle icon="fa-history" toggle="historyShow"></toggle>
    </div>

    <progressbar ng-show="game.duration" value="remain/game.duration*100"></progressbar>
    <div ng-if="userShow">
        <player ng-click="name(player)" ng-class="{myturn:player.id === game.me.id&&player.turn&&game.phase==='submit'}"
                index="$index"
                ng-repeat="player in game.players"
                game="game" player="player">
        </player>
    </div>
    <chat ng-if="chatShow"></chat>
    <history ng-if="historyShow" game="game"></history>
</div>
